From 90b876cb480ca9e092490c825663f23909c6173c Mon Sep 17 00:00:00 2001
From: David Seifert <soap@gentoo.org>
Date: Sun, 17 Sep 2017 23:31:56 +0200
Subject: Add fix for CVE-2015-8107

---
 liba2ps/output.c   | 2 +-
 liba2ps/parseppd.y | 2 +-
 liba2ps/psgen.c    | 2 +-
 src/parsessh.y     | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/liba2ps/output.c b/liba2ps/output.c
index b0011e1..449df0c 100644
--- a/liba2ps/output.c
+++ b/liba2ps/output.c
@@ -518,7 +518,7 @@ output_file (struct output * out, a2ps_job * job,
 		     expand_user_string (job, FIRST_FILE (job),
 					 (const unsigned char *) "Expand: requirement",
 					 (const unsigned char *) token));
-	output (dest, expansion);
+	output (dest, "%s", expansion);
 	continue;
       }
 
diff --git a/liba2ps/parseppd.y b/liba2ps/parseppd.y
index cb393e2..6e50ecb 100644
--- a/liba2ps/parseppd.y
+++ b/liba2ps/parseppd.y
@@ -156,7 +156,7 @@ font_clause :
 void
 yyerror (const char *msg)
 {
-  error_at_line (1, 0, ppdfilename, ppdlineno, msg);
+  error_at_line (1, 0, ppdfilename, ppdlineno, "%s", msg);
 }
 
 /*
diff --git a/liba2ps/psgen.c b/liba2ps/psgen.c
index 8738512..1cc3513 100644
--- a/liba2ps/psgen.c
+++ b/liba2ps/psgen.c
@@ -221,7 +221,7 @@ output_marker (a2ps_job * job, const char * kind, unsigned char * marker)
     default:
       *buf = '\0';
       ps_escape_char (job, cp[i], buf);
-      output (jdiv, (char *) buf);
+      output (jdiv, "%s", (char *) buf);
       break;
     }
   }
diff --git a/src/parsessh.y b/src/parsessh.y
index 78d2039..b301d87 100644
--- a/src/parsessh.y
+++ b/src/parsessh.y
@@ -742,7 +742,7 @@ exception_def_opt:
 void
 yyerror (const char *msg)
 {
-  error_at_line (1, 0, sshfilename, sshlineno, msg);
+  error_at_line (1, 0, sshfilename, sshlineno, "%s", msg);
 }
 
 /*
